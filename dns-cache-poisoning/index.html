<!DOCTYPE html>
<html lang="en">

<head>
    <title></title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="robots" content="noodp"/>

    <link rel="stylesheet" href="https://shanmiteko.github.io/style.css">
    <link rel="stylesheet" href="https://shanmiteko.github.io/color/blue.css">

    <link rel="stylesheet" href="https://shanmiteko.github.io/font-hack-subset.css">

    </head>

<body class="">
<div class="container">
    
    <header class="header">
        <div class="header__inner">
            <div class="header__logo">
                    
                <a href="https://shanmiteko.github.io" style="text-decoration: none;">
                    <div class="logo">
                      
                            :)
                        
                    </div>
                </a>
            </div>
        </div>

        
        
                <nav class="menu">
            <ul class="menu__inner">
                <li class="active"><a href="https://shanmiteko.github.io">blog</a></li>
            
                <li><a href="https://shanmiteko.github.io/tags">tags</a></li>
            
                <li><a href="https://shanmiteko.github.io/about">about</a></li>
            
                <li><a href="https://github.com/shanmiteko" target="_blank" rel="noopener noreferrer">github</a></li>
            </ul>
        </nav>
    
    
        
    </header>
    

    <div class="content">
        
    <div class="post">
        
    <h1 class="post-title"><a href="https://shanmiteko.github.io/dns-cache-poisoning/">DNS污染情况分析</a></h1>
    <div class="post-meta-inline">
        
    <span class="post-date">
            2022-09-28
        </span>

    </div>

    
        <span class="post-tags-inline">
                :: tags:&nbsp;
                <a class="post-tag" href="https://shanmiteko.github.io/tags/dns/">#DNS</a>&nbsp;
                <a class="post-tag" href="https://shanmiteko.github.io/tags/gfw/">#GFW</a></span>
    

        
        <div class="post-content">
            <p>测试<a href="https://public-dns.info/nameservers.txt">public-dns.info</a>全球公共DNS连通性并用其进行DNS解析分析受污染情况</p>
<span id="continue-reading"></span><h2 id="lin-xuan-ke-yong-dnsfu-wu-qi">遴选可用DNS服务器</h2>
<p>使用脚本<a href="https://github.com/shanmiteko/shell_script_db/blob/main/dns_check.sh">dns_check</a></p>
<details>
<summary>运行结果</summary>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>$ time ./dns_check bilibili.com
</span><span>1 - 1001:
</span><span>  1.1.1.1 -&gt; 139.159.241.37
</span><span>  8.8.8.8 -&gt; 139.159.241.37
</span><span>  223.6.6.6 -&gt; 8.134.50.24
</span><span>  185.222.222.222 -&gt; 8.134.50.24
</span><span>1002 - 2002:
</span><span>2003 - 3003:
</span><span>3004 - 4004:
</span><span>4005 - 5005:
</span><span>  9.9.9.9 -&gt; 139.159.241.37
</span><span>  114.114.115.119 -&gt; 119.3.70.188
</span><span>5006 - 6006:
</span><span>  114.114.115.115 -&gt; 47.103.24.173
</span><span>  114.114.114.114 -&gt; 120.92.78.97
</span><span>  185.184.222.222 -&gt; 119.3.70.188
</span><span>6007 - 7007:
</span><span>7008 - 8008:
</span><span>8009 - 9009:
</span><span>9010 - 10010:
</span><span>10011 - 11011:
</span><span>11012 - 12012:
</span><span>12013 - 13013:
</span><span>13014 - 14014:
</span><span>14015 - 15015:
</span><span>./dns_check  123.70s user 113.12s system 191% cpu 2:03.90 total
</span></code></pre>
</details>
<p>可用DNS</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>1.1.1.1
</span><span>8.8.8.8
</span><span>223.6.6.6
</span><span>185.222.222.222
</span><span>9.9.9.9
</span><span>114.114.115.119
</span><span>114.114.115.115
</span><span>114.114.114.114
</span><span>185.184.222.222
</span></code></pre>
<h2 id="shou-wu-ran-yu-ming-ce-shi">受污染域名测试</h2>
<ul>
<li>wikipedia.org</li>
</ul>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>9.9.9.9 -&gt; 162.125.7.1 x
</span><span>114.114.115.119 -&gt; 162.125.7.1 x
</span><span>114.114.114.114 -&gt; 162.125.7.1 x
</span><span>8.8.8.8 -&gt; 162.125.7.1 x
</span><span>1.1.1.1 -&gt; 118.193.240.37 x
</span><span>114.114.115.115 -&gt; 162.125.7.1 x
</span><span>223.6.6.6 -&gt; 157.240.12.50 x
</span><span>185.184.222.222 -&gt; 157.240.12.50 x
</span><span>185.222.222.222 -&gt; 202.160.128.16 x
</span></code></pre>
<ul>
<li>duckduckgo.com</li>
</ul>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>114.114.115.119 -&gt; 108.160.167.165 x
</span><span>114.114.114.114 -&gt; 192.133.77.145 x
</span><span>9.9.9.9 -&gt; 192.133.77.145 x
</span><span>114.114.115.115 -&gt; 192.133.77.145 x
</span><span>1.1.1.1 -&gt; 104.244.46.17 x
</span><span>8.8.8.8 -&gt; 104.244.46.57 x
</span><span>185.222.222.222 -&gt; 192.133.77.145 x
</span><span>185.184.222.222 -&gt; 192.133.77.145 x
</span><span>223.6.6.6 -&gt; 192.133.77.145 x
</span></code></pre>
<ul>
<li>github.com</li>
</ul>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>114.114.115.115 -&gt; 20.205.243.166
</span><span>185.184.222.222 -&gt; 20.205.243.166
</span><span>1.1.1.1 -&gt; 20.205.243.166
</span><span>114.114.115.119 -&gt; 20.205.243.166 x
</span><span>114.114.114.114 -&gt; 20.205.243.166 x
</span><span>9.9.9.9 -&gt; 20.205.243.166 x
</span><span>8.8.8.8 -&gt; 20.205.243.166 x
</span><span>223.6.6.6 -&gt; 20.205.243.166 x
</span><span>185.222.222.222 -&gt; 20.205.243.166
</span></code></pre>
<p>DNS查询返回ip的ASN信息</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>162.125.7.0/24    AS19679 - Dropbox, Inc.
</span><span>118.193.240.37    Beijing CNISP Technology
</span><span>157.240.12.0/24   AS32934 - Facebook, Inc.
</span><span>202.160.128.0/24    AS13414 - Twitter Inc.
</span><span>108.160.160.0/20     AS19679 - Dropbox, Inc.
</span><span>192.133.76.0/23    AS13414 - Twitter Inc.
</span><span>104.244.46.0/24    AS13414 - Twitter Inc.
</span><span>20.192.0.0/10    AS8075 - Microsoft Corporation
</span></code></pre>
<p>*数据来自<a href="https://ipinfo.io/1.1.1.1">ipinfo.io</a></p>
<h2 id="fen-xi">分析</h2>
<p>DNS查询受到旁路污染解析到了被GFW封禁的IP段或不可达IP</p>

        </div>

        
    </div>

    </div>

    
    <footer class="footer">
        <div class="footer__inner">
                <div class="copyright">
                        <span>© 
    2022
 Powered by <a href="https://www.getzola.org/">Zola</a></span>
                    <span class="copyright-theme">
                        <span class="copyright-theme-sep">:: </span>
                        Theme: <a href="https://github.com/pawroman/zola-theme-terminimal/">Terminimal</a> by pawroman
                    </span>
                </div>
            </div>
    </footer>
    

</div>
</body>

</html>
